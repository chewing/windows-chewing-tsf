<?xml version="1.0" encoding="UTF-8"?>

<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
    xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui">
    <Package Name="新酷音輸入法 (TSF)"
        Codepage="65001"
        Language="1028"
        Manufacturer="新酷音輸入法開發團隊"
        Version="1.0.0.1"
        UpgradeCode="8085e4ce-205d-4c44-9450-59ba34163b2a">
        <MediaTemplate EmbedCab="yes" />
        <StandardDirectory Id="ProgramFilesFolder">
            <Directory Id="INSTALLFOLDER32" Name="ChewingTextService">
                <Directory Id="Dictionary" Name="Dictionary">
                    <File Source="Dictionary\swkb.dat" Bitness="always32" />
                    <File Source="Dictionary\symbols.dat" Bitness="always32" />
                    <File Source="Dictionary\tsi.dat" Bitness="always32" />
                    <File Source="Dictionary\word.dat" Bitness="always32" />
                </Directory>
                <File Source="x86\chewing-msvc.dll" Bitness="always32" />
                <File Source="x86\ChewingTextService.dll" Bitness="always32">
                    <Class Advertise="no" Context="InprocServer32" Description="新酷音輸入法 (TSF)"
                        Id="13F2EF08-575C-4D8C-88E0-F67BB8052B84" IconIndex="0"
                        ThreadingModel="apartment" />
                </File>
                <File Source="ChewingPreferences.exe" Bitness="always32" />
                <File Source="chewing-cli.exe" Bitness="always32" />
            </Directory>
        </StandardDirectory>
        <StandardDirectory Id="ProgramFiles64Folder">
            <Directory Id="INSTALLFOLDER64" Name="ChewingTextService">
                <File Source="x64\chewing-msvc.dll" />
                <File Source="x64\ChewingTextService.dll" Bitness="always64">
                    <Class Advertise="no" Context="InprocServer32" Description="新酷音輸入法 (TSF)"
                        Id="13F2EF08-575C-4D8C-88E0-F67BB8052B84" IconIndex="0"
                        ThreadingModel="apartment" />
                </File>
            </Directory>
        </StandardDirectory>
        <Binary Id="tsfreg" SourceFile="tsfreg.exe" />
        <CustomAction Id="RegisterTSF" BinaryRef="tsfreg" ExeCommand="-r '[ProgramFiles64Folder]'" Impersonate="no" Execute="deferred" Return="check" />
        <CustomAction Id="UnregisterTSF" BinaryRef="tsfreg" ExeCommand="-u" Impersonate="no" Execute="deferred" Return="check" />
        <InstallExecuteSequence>
            <Custom Action="RegisterTSF" After="WriteRegistryValues" Condition='Installed="" AND PREVIOUSVERSIONSINSTALLED=""' />
            <Custom Action="UnregisterTSF" Before="RemoveRegistryValues" Condition='PREVIOUSVERSIONSINSTALLED="" AND REMOVE="ALL"' />
        </InstallExecuteSequence>
        <ui:WixUI Id="WixUI_Minimal" />
        <WixVariable Id="WixUILicenseRtf" Value="lgpl-2.1.rtf" />
    </Package>
</Wix>